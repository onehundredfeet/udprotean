image: haxe:4.0-stretch

before_script:
- haxelib install all --always --quiet

test-neko:
  stage: test
  script:
  - haxe test-neko.hxml

test-cpp:
  stage: test
  script:
  - apt-get update
  - apt-get install -yqq build-essential g++
  - haxe test-cpp.hxml

deploy:
  stage: deploy
  before_script:
  - apt-get update
  - apt-get install -yqq zip
  script:
  - mkdir -p build
  - zip build/udprotean.zip -@ < haxelib.lst
